(function(m,u){"object"===typeof exports&&"undefined"!==typeof module?u(exports):"function"===typeof define&&define.amd?define(["exports"],u):u((m.THREE=m.THREE||{},m.THREE.Badminton=m.THREE.Badminton||{}))})(this,function(m){function u(a,b,c,d,f,e,h,g,l,p,r,k){THREE.Geometry.call(this);this.type="ShuttlecockGeometry";var n=(5*a*a+12*c*a+6*c*c)/(4*(2*a+3*c)),q=d/4*(a*a+2*b*a+3*b*b)/(a*a+b*a+b*b),m=void 0===k?a+c:(n*k+q)/(k+1),x=Math.atan((b-a)/(c+d)),z=a+q/d*(b-a);this.parameters={corkRadius:a,skirtRadius:b,
beltHeight:c,skirtHeight:d,widthSegments:f,heightSegments:e,rachisRadius:h,rachisRatio:g,featherWidth:l,featherRatio:p,featherAngle:r,massRatio:k,massCenter:m,corkMassCenter:n,skirtMassCenter:q,corkAngle:x,massToCorkTopLength:a/Math.tan(x),massToCorkCenterLength:m-n,skirtCrossSectionalArea:Math.PI*z*z};k=-a+m;n=new THREE.SphereGeometry(a,f,e,0,2*Math.PI,0,Math.PI/2);this.merge(n,(new THREE.Matrix4).compose(new THREE.Vector3(0,k,0),(new THREE.Quaternion).setFromEuler(new THREE.Euler(0,Math.PI/2,0,
"XYZ")),new THREE.Vector3(1,1,1)),0);k-=c/2;n=new THREE.CylinderGeometry(a,a,c,f,1,!0,0,2*Math.PI);this.merge(n,(new THREE.Matrix4).compose(new THREE.Vector3(0,k,0),(new THREE.Quaternion).setFromEuler(new THREE.Euler(0,0,0,"XYZ")),new THREE.Vector3(1,1,1)),1);k-=c/2;c=new THREE.CircleGeometry(a,f,0,2*Math.PI);this.merge(c,(new THREE.Matrix4).compose(new THREE.Vector3(0,k,0),(new THREE.Quaternion).setFromEuler(new THREE.Euler(Math.PI/2,-Math.PI/2,0,"YXZ")),new THREE.Vector3(1,1,1)),2);n=a-h;a=k-d*
g/(1+g);c=n+(b-n)*g/(1+g);q=new THREE.TorusGeometry(c,h,2*e,f,2*Math.PI);this.merge(q,(new THREE.Matrix4).compose(new THREE.Vector3(0,a,0),(new THREE.Quaternion).setFromEuler(new THREE.Euler(Math.PI/2,-Math.PI/2,0,"YXZ")),new THREE.Vector3(1,1,1)),3);q=(k+a)/2;e=new THREE.TorusGeometry((n+c)/2,h,2*e,f,2*Math.PI);this.merge(e,(new THREE.Matrix4).compose(new THREE.Vector3(0,q,0),(new THREE.Quaternion).setFromEuler(new THREE.Euler(Math.PI/2,-Math.PI/2,0,"YXZ")),new THREE.Vector3(1,1,1)),3);e=(n+b)/2;
b=-Math.atan((b-n)/d);n=d/Math.cos(b);d=k-d/2;h=new THREE.CylinderGeometry(h,h,n,f,1,!1,0,2*Math.PI);for(k=0;k<h.faces.length;k++)h.faces[k].materialIndex=0;k=1/(1+g)*n;g=new THREE.Geometry;g.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(l,p/(1+p)*-k,0),new THREE.Vector3(-l,p/(1+p)*-k,0),new THREE.Vector3(0,-k,0));g.faces.push(new THREE.Face3(0,2,3),new THREE.Face3(0,3,1));g.faceVertexUvs[0].push([new THREE.Vector2(0,1),new THREE.Vector2(0,0),new THREE.Vector2(1,0)],[new THREE.Vector2(1,
1),new THREE.Vector2(0,0),new THREE.Vector2(1,0)]);g.computeFaceNormals();g.computeVertexNormals();for(k=0;k<f;k++)p=2*Math.PI/f*k,n=Math.sin(p)*e,q=Math.cos(p)*e,l=new THREE.Euler(b,p,0,"YXZ"),this.merge(h,(new THREE.Matrix4).compose(new THREE.Vector3(n,d,q),(new THREE.Quaternion).setFromEuler(l),new THREE.Vector3(1,1,1)),3),n=Math.sin(p)*c,p=Math.cos(p)*c,l=(new THREE.Matrix4).makeRotationFromEuler(l).multiply((new THREE.Matrix4).makeRotationY(r)),this.merge(g,(new THREE.Matrix4).compose(new THREE.Vector3(n,
a,p),(new THREE.Quaternion).setFromRotationMatrix(l),new THREE.Vector3(1,1,1)),4)}function y(a,b,c,d,f,e,h,g){THREE.Geometry.call(this);this.type="HyperbolaGeometry";d=void 0!==d?d:8;f=void 0!==f?f:8;e=void 0!==e?e:!1;h=void 0!==h?h:0;g=void 0!==g?g:2*Math.PI;this.parameters={outerRadius:a,innerRadius:b,height:c,radiusSegments:d,heightSegments:f,openEnded:e,thetaStart:h,thetaLength:g};var l=2*a,l=c/2*b/Math.sqrt(l/2*(l/2)-b*b),p=c/f;g/=d;var r=1/d,k=1/f,n=-c/2;c/=2;for(var q=0,m=n,x=0;q<f;q++,m+=
p,x+=k)for(var z=x+k,u=m+p,B=b*Math.sqrt(m*m+l*l)/l,C=b*Math.sqrt(u*u+l*l)/l,y=0,t=h,A=0;y<d;y++,t+=g,A+=r){var I=A+r,w=t+g,v=this.vertices.length;this.vertices.push(new THREE.Vector3(Math.sin(t)*B,m,Math.cos(t)*B),new THREE.Vector3(Math.sin(w)*B,m,Math.cos(w)*B),new THREE.Vector3(Math.sin(t)*C,u,Math.cos(t)*C),new THREE.Vector3(Math.sin(w)*C,u,Math.cos(w)*C));this.faces.push(new THREE.Face3(v+0,v+3,v+2),new THREE.Face3(v+0,v+1,v+3));this.faceVertexUvs[0].push([new THREE.Vector2(A,x),new THREE.Vector2(I,
z),new THREE.Vector2(A,z)],[new THREE.Vector2(A,x),new THREE.Vector2(I,x),new THREE.Vector2(I,z)])}if(!e)for(q=0,t=h;q<d;q++,t+=g)w=t+g,v=this.vertices.length,this.vertices.push(new THREE.Vector3(0,c,0),new THREE.Vector3(Math.sin(t)*a,c,Math.cos(t)*a),new THREE.Vector3(Math.sin(w)*a,c,Math.cos(w)*a)),this.faces.push(new THREE.Face3(v+0,v+1,v+2,null,null,1)),this.faceVertexUvs[0].push([new THREE.Vector2(.5,.5),new THREE.Vector2(.5+.5*Math.cos(t),.5+.5*Math.sin(t)),new THREE.Vector2(.5+.5*Math.cos(w),
.5+.5*Math.sin(w))]),v+=3,this.vertices.push(new THREE.Vector3(0,n,0),new THREE.Vector3(Math.sin(t)*a,n,Math.cos(t)*a),new THREE.Vector3(Math.sin(w)*a,n,Math.cos(w)*a)),this.faces.push(new THREE.Face3(v+0,v+2,v+1,null,null,2)),this.faceVertexUvs[0].push([new THREE.Vector2(.5,.5),new THREE.Vector2(.5+.5*Math.cos(w),.5-.5*Math.sin(w)),new THREE.Vector2(.5+.5*Math.cos(t),.5-.5*Math.sin(t))]);this.computeFaceNormals();this.computeVertexNormals()}function D(a,b,c,d,f,e){THREE.Geometry.call(this);this.type=
"NetGeometry";d=void 0!==d?d:c;f=void 0!==f?f:1;e=void 0!==e?e:1;this.parameters={width:a,height:b,outerTube:c,innerTube:d,widthSegments:f,heightSegments:e};var h=new THREE.PlaneGeometry(c,b),g=new THREE.PlaneGeometry(a,c);this.merge(h,(new THREE.Matrix4).compose(new THREE.Vector3(-a/2+c/2,0,0),(new THREE.Quaternion).setFromEuler(new THREE.Euler(0,0,0,"XYZ")),new THREE.Vector3(1,1,1)),0);this.merge(h,(new THREE.Matrix4).compose(new THREE.Vector3(a/2-c/2,0,0),(new THREE.Quaternion).setFromEuler(new THREE.Euler(0,
0,0,"XYZ")),new THREE.Vector3(1,1,1)),0);this.merge(g,(new THREE.Matrix4).compose(new THREE.Vector3(0,b/2-c/2,0),(new THREE.Quaternion).setFromEuler(new THREE.Euler(0,0,0,"XYZ")),new THREE.Vector3(1,1,1)),0);this.merge(g,(new THREE.Matrix4).compose(new THREE.Vector3(0,-b/2+c/2,0),(new THREE.Quaternion).setFromEuler(new THREE.Euler(0,0,0,"XYZ")),new THREE.Vector3(1,1,1)),0);var g=new THREE.PlaneGeometry(d,b),h=new THREE.PlaneGeometry(a,d),l=(a-2*c-d*(f-1))/f,p=-a/2+c+l+d/2;for(a=0;a<f-1;a++,p+=l+d)this.merge(g,
(new THREE.Matrix4).compose(new THREE.Vector3(p,0,0),(new THREE.Quaternion).setFromEuler(new THREE.Euler(0,0,0,"XYZ")),new THREE.Vector3(1,1,1)),1);f=(b-2*c-d*(e-1))/e;b=-b/2+c+f+d/2;for(a=0;a<e-1;a++,b+=f+d)this.merge(h,(new THREE.Matrix4).compose(new THREE.Vector3(0,b,0),(new THREE.Quaternion).setFromEuler(new THREE.Euler(0,0,0,"XYZ")),new THREE.Vector3(1,1,1)),1)}function E(a,b,c,d,f,e){THREE.Geometry.call(this);this.type="CourtGeometry";this.parameters={shortLine:a,longLineSingle:b,longLineDouble:c,
sidelineSingle:d,sidelineDouble:f,lineWidth:e};for(var h=new THREE.PlaneGeometry(e,2*f),g=[a+e/2,c-e/2,b-e/2],l=0;l<g.length;l++)for(c=-1;1>=c;c+=2)this.merge(h,(new THREE.Matrix4).compose(new THREE.Vector3(g[l]*c,0,0),(new THREE.Quaternion).setFromEuler(new THREE.Euler(0,0,0,"XYZ")),new THREE.Vector3(1,1,1)),0);this.merge(h,(new THREE.Matrix4).compose(new THREE.Vector3(0,0,0),(new THREE.Quaternion).setFromEuler(new THREE.Euler(0,0,0,"XYZ")),new THREE.Vector3(1,1,1)),0);h=new THREE.PlaneGeometry(2*
b,e);d=[d-e/2,f-e/2];for(l=0;l<d.length;l++)for(c=-1;1>=c;c+=2)this.merge(h,(new THREE.Matrix4).compose(new THREE.Vector3(0,d[l]*c,0),(new THREE.Quaternion).setFromEuler(new THREE.Euler(0,0,0,"XYZ")),new THREE.Vector3(1,1,1)),0);e=new THREE.PlaneGeometry(b-a,e);for(c=-1;1>=c;c+=2)this.merge(e,(new THREE.Matrix4).compose(new THREE.Vector3((a+b)/2*c,0,0),(new THREE.Quaternion).setFromEuler(new THREE.Euler(0,0,0,"XYZ")),new THREE.Vector3(1,1,1)),0)}function F(a,b,c,d,f,e,h,g){THREE.Geometry.call(this);
this.type="RacketGeometry";h=void 0!==h?h:16;g=void 0!==g?g:16;this.parameters={width:a,height:b,tube:c,lineWidth:d,widthSegments:f,heightSegments:e,radialSegments:h,tubularSegments:g};a=a/2-c;b=b/2-c;for(var l=h*g,p=0;p<h;p++)for(var m=0;m<g;m++){var k=p/g*Math.PI*2,n=m/h*Math.PI*2,q=this.vertices.length;this.vertices.push(new THREE.Vector3((a+c*Math.cos(n))*Math.cos(k),(b+c*Math.cos(n))*Math.sin(k),c*Math.sin(n)));k=q+0;q+=1;m===g-1&&(q-=g);n=(q+g)%l;this.faces.push(new THREE.Face3(k,(k+g)%l,n),
new THREE.Face3(k,n,q));this.faceVertexUvs[0].push([new THREE.Vector2(0,1),new THREE.Vector2(0,0),new THREE.Vector2(1,0)],[new THREE.Vector2(1,1),new THREE.Vector2(0,0),new THREE.Vector2(1,0)])}g=2*(a-c);h=d+(g-d*(f-1))/f;p=0;for(g=-g/2-d/2+h;p<f-1;p++,g+=h)l=new THREE.PlaneGeometry(d,2*b*Math.sin(Math.acos(g/a))),this.merge(l,(new THREE.Matrix4).compose(new THREE.Vector3(g,0,0),(new THREE.Quaternion).setFromEuler(new THREE.Euler(0,0,0,"XYZ")),new THREE.Vector3(1,1,1)),1);f=2*(b-c);c=d+(f-d*(e-1))/
e;p=0;for(f=-f/2-d/2+c;p<e-1;p++,f+=c)h=new THREE.PlaneGeometry(2*a*Math.cos(Math.asin(f/b)),d),this.merge(h,(new THREE.Matrix4).compose(new THREE.Vector3(0,f,0),(new THREE.Quaternion).setFromEuler(new THREE.Euler(0,0,0,"XYZ")),new THREE.Vector3(1,1,1)),1);this.computeFaceNormals();this.computeVertexNormals()}function G(a){var b={},c;for(c in a)b[c]=a[c];b.uniforms={texture:{value:a.map},size:{value:a.size},pixelSize:{value:a.pixelSize}};b.vertexShader="varying vec2 vUv;\r\nvoid main() {\r\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n\tvUv = uv;\r\n}";
b.fragmentShader="uniform sampler2D texture;\r\nuniform vec2 size;\r\nuniform vec2 pixelSize;\r\nvarying vec2 vUv;\r\n\r\nvoid main() {\r\n\t\r\n\tvec2 pixelRatio = pixelSize / size;\r\n\tgl_FragColor = vec4(texture2D(texture, pixelRatio * floor(vUv / pixelRatio)).rgb, 1.0); \r\n}";delete b.map;delete b.size;delete b.pixelSize;THREE.ShaderMaterial.call(this,b)}function J(a,b,c,d,f,e,h,g){THREE.Object3D.call(this);a instanceof u&&(f=a.parameters.corkAngle,e=a.parameters.massToCorkTopLength,h=a.parameters.massToCorkCenterLength,
g=a.parameters.skirtCrossSectionalArea);this.geometry=a;this.material=b;this.parameters={mass:c+d,corkMass:c,skirtMass:d,corkAngle:f,massToCorkTopLength:e,massToCorkCenterLength:h,skirtCrossSectionalArea:g};c=new THREE.Object3D;this.add(c);a=new THREE.Mesh(a,b);c.add(a);this.flipFrame=c;this.mesh=a;this.dragCoefficient=.44;this.airDensity=1.1839;this.gravity=new THREE.Vector3(0,-9.8,0);this.toppleAngularVelocity=3*Math.PI;this.init()}function K(a,b){function c(a){for(var c=new THREE.Object3D,d=c,
e=0;e<a.length;e++){var f=a[e],g=String.fromCharCode("A".charCodeAt()+e),k=new THREE.Object3D;d.add(k);c["axis"+g]=f;c["frame"+g]=k;(function(a,b){var d=0;Object.defineProperty(c,"angle"+g,{get:function(){return d},set:function(c){d=c;a.quaternion.setFromAxisAngle(b,c)}})})(k,f);d=k}a=b.clone();a.position.y=h.y/2;d.add(a);c.racket=a;return c}THREE.Object3D.call(this);var d=(new THREE.Box3).setFromLocalObject(a),f=d.getSize(),d=d.getCenter(),e=(new THREE.Box3).setFromLocalObject(b),h=e.getSize(),g=
e.getCenter(),e=f.x,l=f.y,p=h.y;this.parameters={bodySize:f,bodyCenter:d,racketSize:h,racketCenter:g,bodyWidth:e,bodyHeight:l,bodyDepth:f.z,racketLength:p,racketWidth:h.x,racketDepth:h.z};g=a.clone();g.position.set(-d.x,-d.y+f.y/2,-d.z);this.add(g);var m=c([new THREE.Vector3(1,0,0),new THREE.Vector3(-1,0,0)]);m.position.set(0,d.y+f.y/2,0);g.add(m);var k=c([new THREE.Vector3(0,-1,0),new THREE.Vector3(-1,0,0)]);k.rotation.z=-Math.PI/2;k.position.set(d.x+f.x/2,d.y,0);g.add(k);var n=c([new THREE.Vector3(0,
1,0),new THREE.Vector3(-1,0,0)]);n.rotation.z=Math.PI/2;n.position.set(d.x-f.x/2,d.y,0);g.add(n);this.body=g;this.leftLink=k;this.leftImpactWidth=e/2+p/2;this.leftImpactHeight=l/2;this.rightLink=n;this.rightImpactWidth=e/2+p/2;this.rightImpactHeight=l/2;this.topLink=m;this.topImpactWidth=0;this.topImpactAngle=-Math.PI/15;this.impactClock=new THREE.Clock;this.impactClock.start();this.impactDelta=1;this.responsibleArea=new THREE.Box3(new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,0));this.responsibleAreaEpsilon=
.1;this.shuttle=null;this.racketAttenuation=.9;this.bodySpeed=1E3;this.bodyAngularSpeed=2*Math.PI;this.linkAngularSpeed=2*Math.PI;this.netHeight=1.55;this.netHeightDelta=.2;this.targetPosition=new THREE.Vector3(0,0,0);this.impactType="right";this.smashSpeed=100*Math.PI;this.healthAttenuation=.99;this.record=null;this.init()}function L(a,b){THREE.Mesh.call(this,a,b)}function H(a,b,c){THREE.Object3D.call(this);this.parameters={width:a,height:b,font:c};a=new THREE.Mesh(new THREE.PlaneGeometry(a,b),new THREE.MeshBasicMaterial({side:THREE.DoubleSide}));
this.add(a);this.plane=a;this.textMesh=null}function M(a,b,c,d){THREE.Object3D.call(this);this.parameters={width:a,height:b,depth:c,cardGap:d};var f=Math.atan(c/2/b),e=Math.sqrt(Math.pow(c/2,2)+Math.pow(b,2)),h=new THREE.Mesh(new THREE.PlaneGeometry(a,e),new THREE.MeshNormalMaterial({side:THREE.DoubleSide}));h.position.y=b/2;h.position.z=c/4;h.rotation.x=-f;this.add(h);h=new THREE.Mesh(new THREE.PlaneGeometry(a,e),new THREE.MeshNormalMaterial({side:THREE.DoubleSide}));h.position.y=b/2;h.position.z=
-c/4;h.rotation.x=f;this.add(h);c=new THREE.Mesh(new THREE.PlaneGeometry(a,c),new THREE.MeshNormalMaterial({side:THREE.DoubleSide}));c.rotation.x=Math.PI/2;this.add(c);var g=e-2*d,l=(a-5*d)/3,m=new THREE.Object3D;m.position.y=1.01*b;this.add(m);var r=[1.5*-d-1.25*l,1.5*-d-1*l,1.5*-d-.75*l,.5*-d-.25*l,.5*+d+.25*l,1.5*+d+.75*l,1.5*+d+1*l,1.5*+d+1.25*l];for(a=0;a<r.length;a++)b=new THREE.Mesh(new THREE.TorusGeometry(15,1,16,16),new THREE.MeshNormalMaterial({side:THREE.DoubleSide})),b.position.x=r[a],
b.rotation.y=Math.PI/2,m.add(b);var k=this;(new THREE.FontLoader).load("https://ikatyang.github.io/three.badminton.js/fonts/gentilis_regular.typeface.json",function(a){function b(c,e,f,h,k){var q=new H(l*e,g*e,a);q.setText(c);q.position.x=f;q.rotation.x=h;q.visible=k;q.plane.position.y=-g*e/2-d;m.add(q);return q}k.frontCards=[k.frontCard1=b("0",1,r[1],2*Math.PI-f,!0),k.frontSmallCard1=b("0",.5,r[3],2*Math.PI-f,!0),k.frontSmallCard2=b("0",.5,r[4],2*Math.PI-f,!0),k.frontCard2=b("0",1,r[6],2*Math.PI-
f,!0)];k.backCards=[k.backCard1=b(null,1,r[1],f,!0),k.backSmallCard1=b(null,.5,r[3],f,!0),k.backSmallCard2=b(null,.5,r[4],f,!0),k.backCard2=b(null,1,r[6],f,!0)];k.animateCards=[k.animateCard1=b(null,1,r[1],0,!1),k.animateSmallCard1=b(null,.5,r[3],0,!1),k.animateSmallCard2=b(null,.5,r[4],0,!1),k.animateCard2=b(null,1,r[6],0,!1)]});this.speed=2*Math.PI;this.actions=[null,null,null,null]}function N(a,b){THREE.Object3D.call(this);this.parameters={radius:a,tube:b};var c=new THREE.Mesh(new THREE.TorusGeometry(a,
b,16,12),new THREE.MeshNormalMaterial);c.rotation.x=Math.PI/2;this.add(c);var d=new THREE.Geometry;d.vertices.push(new THREE.Vector3(-.5,2,0),new THREE.Vector3(.5,2,0),new THREE.Vector3(-.5,1,0),new THREE.Vector3(.5,1,0),new THREE.Vector3(-1,1,0),new THREE.Vector3(1,1,0),new THREE.Vector3(0,0,0));d.faces.push(new THREE.Face3(3,0,2),new THREE.Face3(3,1,0),new THREE.Face3(6,5,4));d.computeBoundingSphere();d.computeFaceNormals();d.computeVertexNormals();d=new THREE.Mesh(d,new THREE.MeshNormalMaterial);
d.scale.set(a,a,a);d.position.y=1.5*a;this.add(d);this.ring=c;this.arrow=d;this.arrowDir=-1;this.arrowMinY=a;this.arrowMaxY=2*a;this.arrowSpeed=2*a}function O(a,b,c){this.court=a;this.shuttle=b;this.score2=this.score1=this.nthScore=0;this.lastWinner=void 0!==c?c:1;this.scoreboard=null}function P(a,b,c,d,f,e,h,g){this.shuttlecock=a;this.robot1=b;this.robot2=c;this.game=d;this.scoreboard=f;this.targetPoint1=e;this.targetPoint2=h;this.resetCounter();this.playing=!1;this.init(g)}window.performance=window.performance||
Date;void 0===THREE.Object3D.prototype.localToTarget&&(THREE.Object3D.prototype.localToTarget=function(a,b,c){if(a instanceof THREE.Vector3)switch(c){case "direction":return this.localToTarget(a,b).sub(this.localToTarget(new THREE.Vector3(0,0,0),b));default:return b.worldToLocal(this.localToWorld(a))}else if(a instanceof THREE.Box3)return c=this.localToTarget(a.min.clone(),b),b=this.localToTarget(a.max.clone(),b),a.setFromPoints([c,b])});void 0===THREE.Box3.prototype.setFromLocalObject&&(THREE.Box3.prototype.setFromLocalObject=
function(a){var b=(new THREE.Box3).setFromObject(a),c=a.worldToLocal(b.min);a=a.worldToLocal(b.max);return this.setFromPoints([c,a])});void 0===THREE.Box3.prototype.fromArray&&(THREE.Box3.prototype.fromArray=function(a){this.setFromArray(a);return this});void 0===THREE.Box3.prototype.toArray&&(THREE.Box3.prototype.toArray=function(){return this.min.toArray().concat(this.max.toArray())});u.prototype=Object.create(THREE.Geometry.prototype);u.prototype.constructor=u;y.prototype=Object.create(THREE.Geometry.prototype);
y.prototype.constructor=y;D.prototype=Object.create(THREE.Geometry.prototype);D.prototype.constructor=D;E.prototype=Object.create(THREE.Geometry.prototype);E.prototype.constructor=E;F.prototype=Object.create(THREE.Geometry.prototype);F.prototype.constructor=F;G.prototype=Object.create(THREE.ShaderMaterial.prototype);G.prototype.constructor=G;J.prototype=Object.assign(Object.create(THREE.Object3D.prototype),{constructor:J,init:function(){this.state="active";this.flipFrame.rotation.set(0,0,0);this.velocity=
new THREE.Vector3(0,0,0);this.flipAngularVelocity=this.flipAngle=0;this.flipAxis=new THREE.Vector3(0,0,0);this.impactCount=this.lastDelta=0},getYAxis:function(){this.flipFrame.updateMatrixWorld();return this.flipFrame.localToTarget(new THREE.Vector3(0,1,0),this.parent,"direction").normalize()},impact:function(a,b,c,d){this.velocity.reflect(b).multiplyScalar(1-c).add(a);b=this.getYAxis();this.updateActive(0);this.updateMatrixWorld();a=this.parent.localToTarget(this.velocity.clone().cross(b),this,"direction").normalize();
this.flipAngle=b=this.velocity.angleTo(b);this.flipAngularVelocity=0;this.flipAxis=a;a=(new THREE.Matrix4).makeRotationAxis(a,b);this.flipFrame.rotation.setFromRotationMatrix(a);!1!==d&&this.impactCount++;this.onAfterImpact()},update:function(a){"active"===this.state?this.updateActive(a):"toppling"===this.state&&this.updateToppling(a);this.lastDelta=a},updateActive:function(a){var b=this.airDensity,c=this.parameters.skirtCrossSectionalArea,d=this.dragCoefficient,f=this.velocity.length(),b=b*c*d*f*
f/2,b=this.velocity.clone().normalize().multiplyScalar(-b),b=this.gravity.clone().multiplyScalar(this.parameters.mass).add(b);this.velocity.addScaledVector(b,a/this.parameters.mass);this.position.addScaledVector(this.velocity,a);b=this.velocity.clone().cross(this.gravity).normalize();0<b.length()&&(c=this.velocity.clone().normalize(),d=b.clone().cross(c).normalize(),b=(new THREE.Matrix4).makeBasis(b,c,d),this.rotation.setFromRotationMatrix(b));0<a&&(b=[this.flipAngle,this.flipAngularVelocity],this.solveODE(b,
this.flipDerivative,a),this.flipAngle=b[0],this.flipAngularVelocity=b[1],Math.abs(this.flipAngle)<Math.PI?(a=(new THREE.Matrix4).makeRotationAxis(this.flipAxis,this.flipAngle),this.flipFrame.rotation.setFromRotationMatrix(a)):this.flipFrame.rotation.set(0,0,0));0>this.position.y&&(this.state="toppling")},updateToppling:function(a){this.rotation.setFromRotationMatrix((new THREE.Matrix4).makeRotationFromEuler(this.rotation).multiply((new THREE.Matrix4).makeRotationFromEuler(this.flipFrame.rotation)));
this.flipFrame.rotation.set(0,0,0);this.flipAngle=0;var b=this.getYAxis(),c=this.velocity.clone().setY(0).normalize();b.clone().negate().angleTo(c)>Math.PI/2&&c.negate();var d=this.parent.localToTarget(b.clone().negate().cross(c),this,"direction").normalize();a=Math.min(this.toppleAngularVelocity*a,b.clone().negate().angleTo(c)-this.parameters.corkAngle);b=(new THREE.Matrix4).makeRotationFromEuler(this.rotation);this.rotation.setFromRotationMatrix(b.multiply((new THREE.Matrix4).makeRotationAxis(d,
a)));this.position.y-=this.localToTarget(new THREE.Vector3(0,this.parameters.massToCorkTopLength,0),this.parent).y;1E-4>a&&(this.state="toppled")},flipDerivative:function(a){var b=a[0];a=a[1];var c=this.airDensity,d=this.dragCoefficient,f=this.velocity.length(),e=this.parameters.skirtMass,h=this.parameters.corkMass,g=this.parameters.skirtCrossSectionalArea;return[a,-(c*g*d*f)/(2*e*(1+e/h))*a-c*g*d*f*f/(2*(h+e)*this.parameters.massToCorkCenterLength)*Math.sin(b)]},solveODE:function(a,b,c){for(var d=
a.slice(0),d=b.call(this,d),f=a.slice(0),e=0;e<a.length;e++)f[e]+=c/2*d[e];for(var f=b.call(this,f),h=a.slice(0),e=0;e<a.length;e++)h[e]+=c/2*f[e];for(var h=b.call(this,h),g=a.slice(0),e=0;e<a.length;e++)g[e]+=h[e]*c;b=b.call(this,g);for(e=0;e<a.length;e++)a[e]+=(d[e]+2*f[e]+2*h[e]+b[e])/6*c;return a},onAfterImpact:function(){}});K.prototype=Object.assign(Object.create(THREE.Object3D.prototype),{constructor:K,init:function(){this.impactCount=0;this.healthPercent=100;this.topLink.angleA=this.topLink.angleB=
0;this.leftLink.angleA=this.leftLink.angleB=0;this.rightLink.angleA=this.rightLink.angleB=0},setResponsibleArea:function(a,b){this.responsibleArea=a;b&&this.position.copy(a.min.clone().add(a.max).divideScalar(2))},predictFallingTime:function(a){return(a-this.shuttle.position.y)/this.shuttle.velocity.y},predictFallingPosition:function(a){var b=this.predictFallingTime(a);return-.01>b?null:this.shuttle.position.clone().addScaledVector(this.shuttle.velocity,b).add(this.shuttle.position).divideScalar(2).setY(a)},
getRacketImpactLength:function(){return this.parameters.racketSize.y/2},getRacketImpactPosition:function(a,b){return a.localToTarget((new THREE.Vector3(0,this.getRacketImpactLength(),0)).applyAxisAngle(a.axisA,b),this)},getImpactParams:function(){switch(this.impactType){case "top":return this.getImpactParamsTop();case "left":return this.getImpactParamsLeft();case "right":return this.getImpactParamsRight();case "smash":return this.getImpactParamsSmash()}},getImpactParamsTop:function(){var a=this.topLink,
b=this.topImpactAngle,c=this.getRacketImpactPosition(a,b).y,d=this.getTopImpactSpeed(c),f=this.predictFallingPosition(c);return{link:a,impactAngle:b,impactHeight:c,impactSpeed:d,impactPosition:f}},getImpactParamsLeft:function(){var a=this.leftLink,b=this.leftImpactHeight,c=this.getImpactAngleAndSpeed(b),d=c[0],c=c[1],f=this.predictFallingPosition(b);return{link:a,impactAngle:d,impactHeight:b,impactSpeed:c,impactPosition:f}},getImpactParamsRight:function(){var a=this.rightLink,b=this.rightImpactHeight,
c=this.getImpactAngleAndSpeed(b),d=c[0],c=c[1],f=this.predictFallingPosition(b);return{link:a,impactAngle:d,impactHeight:b,impactSpeed:c,impactPosition:f}},getImpactParamsSmash:function(){var a=this.targetPosition,b=new THREE.Vector3(0,this.netHeight+this.netHeightDelta,1),c=new THREE.Vector3(0,this.netHeight+this.netHeightDelta,-1),b=b.clone().sub(a),c=c.clone().sub(a),c=b.clone().cross(c),b=this.shuttle.velocity,d=this.shuttle.position,c=a.clone().sub(d).dot(c)/b.clone().dot(c),b=b.clone().multiplyScalar(c).add(d),
d=this.topLink,a=Math.PI/2-b.clone().sub(a).angleTo(new THREE.Vector3(0,1,0));return{link:d,impactAngle:a,impactHeight:b.y,impactSpeed:this.smashSpeed,impactPosition:-1E4<c?b:null}},update:function(a){this.onBeforeUpdate();var b=this.getImpactParams(),c=b.link,d=b.impactAngle,f=b.impactSpeed,e=b.impactHeight,h=b.impactPosition;if(0!==this.impactCount&&this.shuttle.impactCount!==this.impactCount+1||"active"!==this.shuttle.state||!h||0===this.responsibleArea.min.x&&0>h.x||0===this.responsibleArea.max.x&&
0<h.x||h.x<this.responsibleArea.min.x+(this.responsibleArea.min.x-this.responsibleArea.max.x)*this.responsibleAreaEpsilon||h.x>this.responsibleArea.max.x+(this.responsibleArea.max.x-this.responsibleArea.min.x)*this.responsibleAreaEpsilon||h.z<this.responsibleArea.min.z+(this.responsibleArea.min.z-this.responsibleArea.max.z)*this.responsibleAreaEpsilon||h.z>this.responsibleArea.max.z+(this.responsibleArea.max.z-this.responsibleArea.min.z)*this.responsibleAreaEpsilon)e=d=b=0,h=this.responsibleArea.min.clone().add(this.responsibleArea.max).divideScalar(2);
else var b=this.parent.localToTarget(this.targetPosition.clone().sub(h).setY(0),this,"direction"),b=b.angleTo(new THREE.Vector3(0,0,1))*(0>b.x?-1:1),g=this.getRacketImpactPosition(c,d),g=this.localToTarget(g.clone(),this.parent,"direction"),h=h.clone().sub(g),e=this.predictFallingTime(e),g=Math.PI/f,e=0>e||e>g?0:e<g/2?THREE.Math.clamp(e*f,0,Math.PI):THREE.Math.clamp(Math.PI/2-(e-g/2)*f,0,Math.PI);c.angleB=0;c.updateMatrixWorld();this.checkIntersect(c.racket,this.shuttle)&&this.impactClock.getDelta()>
this.impactDelta&&(g=c.racket.localToTarget(new THREE.Vector3(0,0,1),this.parent,"direction"),this.shuttle.impact(g.clone().multiplyScalar(f*this.getRacketImpactLength()),g,this.racketAttenuation),this.impactCount=this.shuttle.impactCount,this.healthPercent*=this.healthAttenuation,this.record&&(this.record.playing?this.record.playRobot():this.record.recordRobot(this)),this.onAfterImpact());c.angleB=e;d-=c.angleA;f=this.linkAngularSpeed*a*(0>d?-1:1);c.angleA+=Math.abs(d)<Math.abs(f)?d:f;c=h.clone().sub(this.position);
d=c.clone().setLength(this.healthPercent/100*a*this.bodySpeed);c=c.length()<d.length()?c:d;this.position.add(c);b-=this.body.rotation.y;a=this.bodyAngularSpeed*a*(0>b?-1:1);this.body.rotation.y+=Math.abs(b)<Math.abs(a)?b:a},checkIntersect:function(a,b){a.updateMatrixWorld();b.updateMatrixWorld();null===b.geometry.boundingSphere&&b.geometry.computeBoundingSphere();null===a.geometry.boundingBox&&a.geometry.computeBoundingBox();var c=a.geometry.boundingBox,d=b.geometry.boundingSphere,f=b.localToTarget(d.center.clone(),
this.parent),e=f.clone().addScaledVector(this.shuttle.velocity,-this.shuttle.lastDelta);this.parent.localToTarget(f,a);this.parent.localToTarget(e,a);var h=!1,g=e.clone().sub(f),e=-f.z/g.z;if(1>=Math.abs(e)||0>e*this.lastCheckMul)f=f.clone().addScaledVector(g,e),h=this.checkIntersectRectAndCircle(c.clone().translate(f.clone().negate()),d.radius),this.lastCheckMul=e;return h},checkIntersectRectAndCircle:function(a,b){return 0>a.max.x?0>a.max.y?a.max.x*a.max.x+a.max.y*a.max.y<b*b:0<a.min.y?a.max.x*
a.max.x+a.min.y*a.min.y<b*b:Math.abs(a.max.x)<b:0<a.min.x?0>a.max.y?a.min.x*a.min.x+a.max.y*a.max.y<b*b:0<a.min.y?a.min.x*a.min.x+a.min.y*a.min.y<b*b:Math.abs(a.min.x)<b:0>a.max.y?Math.abs(a.max.y)<b:0<a.min.y?Math.abs(a.min.y)<b:!0},getTopImpactSpeed:function(a){var b=this.shuttle.position.clone().setY(0),c=this.targetPosition.clone().sub(b);a=c.clone().length();b=Math.abs(b.clone().distanceTo(c));b=Math.ceil(b/100)-2;for(0>b&&(b=0);b<this.topForceTable.length&&!(this.topForceTable[b][0]>a);b++);
0!==b&&b--;return Math.PI*this.topForceTable[b][1]},getImpactAngleAndSpeed:function(a){var b=this.hitAngleSpeed();return[Math.atan((this.netHeight-a)/(b[0]*b[2])),Math.PI*b[1]*2]},hitAngleSpeed:function(){var a=this.forceTable,b,c;b=this.shuttle.position.clone().setY(0);var d=this.targetPosition.clone().sub(b).length();c=Math.abs(b.x);for(b=0;b<a.length&&!(c<a[b][0]);b++);0!==b&&b--;for(c=1;c<a[b].length&&!(d<a[b][c][0]);c++);return 1===c?(d=this.searchNearTable(b,d),[a[b][0],d[0],d[1]]):[a[b][0],
c===a[b].length?a[b][c-1][1]:a[b][c-1][1]+.8*(d-a[b][c-1][0])/(a[b][c][0]-a[b][c-1][0])*(a[b][c][1]-a[b][c-1][1]),.5]},searchNearTable:function(a,b){for(var c=this.nearForceTable,d=0;d<c[a].length&&!(b<c[a][d][0]);d++);if(d!==c[a].length&&0!==d)return b-c[a][d-1][0]<c[a][d][0]-b?[c[a][d-1][1],c[a][d-1][2]]:[c[a][d][1],c[a][d][2]];0!==d&&d--;return[c[a][d][1],c[a][d][2]]},forceTable:[[50,[137.985,4],[171.764,5],[181.607,5.5],[196.202,6],[210.167,6.5]],[60,[199.854,5],[227.5,6],[257.592,7],[287.615,
8]],[100,[275.066,5],[324.661,6],[361.542,7],[390.883,8],[424.454,9],[453.068,10],[502.904,12],[522.702,13],[564.443,15]],[200,[410.093,6],[458.291,7],[507.016,8],[559.387,9],[592.505,10],[665.365,12],[699.139,13],[722.29,14],[747.837,15],[799.139,17],[821.3,18],[836.071,19]],[300,[534.076,8],[592.751,9],[614.948,10],[691.248,12],[734.713,13],[756.567,14],[792.024,15],[872.006,18],[906.458,20],[947.016,22],[964.18,23],[981.645,24]],[400,[688.696,12],[719.63,13],[723.163,14],[756.823,15],[778.991,
16],[825.065,18],[869.899,20],[907.816,22],[968.375,25],[985.026,28],[1026.356,30],[1045.12,32],[1082.599,35]],[500,[799.488,16],[841.45,18],[887.547,20],[910.274,22],[952.236,25],[993.63,28],[1016.415,30],[1043.966,33],[1069.137,35],[1084.272,38],[1102.328,45],[1125.554,50]],[600,[832.078,18],[870.521,20],[918.2,23],[945.298,25],[1001.864,30],[1047.207,35],[1085.517,40],[1120.521,45],[1142.557,50],[1159.886,55],[1179.336,60],[1183.502,65]],[670,[919.055,25],[976.644,30],[1022.786,35],[1060.423,40],
[1096.539,45],[1126.575,50],[1140.54,55],[1155.065,60],[1160.136,65],[1165.34,70],[1185.009,75]]],nearForceTable:[[[116.17,4,.5],[133.989,4,.6]],[[110.709,4,.4],[133.989,4,.5],[155.276,4,.6]],[[171.218,4,.4],[197.541,4,.5],[211.025,5,.4],[220.771,4,.6],[247.074,5,.5],[274.574,5,.6]],[[316.081,5,.4],[361.806,5,.6],[417.773,6,.6]],[[417.841,6,.4],[439.847,6,.5],[473.036,7,.4],[504.056,7,.6]],[[551.695,9,.4],[597.663,10,.6],[633.222,11,.6]],[[684.329,12,.5],[706.157,13,.6],[749.17,14,.3],[762.856,14,
.5]],[[666.356,12,.2],[730.342,13,.4],[748.811,14,.5]],[[838.084,19,.4],[842.727,20,.6],[860.917,21,.6]]],topForceTable:[[432.837,12],[508.317,15],[612.811,20],[697.075,25],[767.586,30],[793.203,32],[829.48,35],[849.617,37],[860.173,38],[880.123,40],[925.701,45],[966.793,50],[1002.28,55],[1036.857,60],[1064.451,65],[1091.885,70],[1118.193,75],[1140.245,80],[1160.976,85],[1182.143,90],[1200.124,95],[1217.301,100],[1233.056,105],[1248.758,110],[1261.102,115],[1274.775,120],[1287.784,125],[1298.189,
130],[1309.88,135],[1321.354,140],[1329.665,145],[1333.054,150]],topTableStart:[0,1,2,3,5,6],onAfterImpact:function(){},onBeforeUpdate:function(){}});L.prototype=Object.assign(Object.create(THREE.Mesh.prototype),{constructor:L,inArea:function(a,b){return this.getArea(a).containsPoint(b)},getArea:function(a){return this["getArea"+a]()},getAreaAll:function(){return new THREE.Box3(new THREE.Vector3(-this.geometry.parameters.longLineSingle,-this.geometry.parameters.sidelineDouble,0),new THREE.Vector3(this.geometry.parameters.longLineSingle,
this.geometry.parameters.sidelineDouble,0))},getAreaSingle:function(){return new THREE.Box3(new THREE.Vector3(-this.geometry.parameters.longLineSingle,-this.geometry.parameters.sidelineSingle,0),new THREE.Vector3(this.geometry.parameters.longLineSingle,this.geometry.parameters.sidelineSingle,0))},getAreaSingleA:function(){return new THREE.Box3(new THREE.Vector3(-this.geometry.parameters.longLineSingle,-this.geometry.parameters.sidelineSingle,0),new THREE.Vector3(0,this.geometry.parameters.sidelineSingle,
0))},getAreaSingleFirstA:function(){return new THREE.Box3(new THREE.Vector3(-this.geometry.parameters.longLineSingle,-this.geometry.parameters.sidelineSingle,0),new THREE.Vector3(-this.geometry.parameters.shortLine,this.geometry.parameters.sidelineSingle,0))},getAreaSingleFirstLeftA:function(){return new THREE.Box3(new THREE.Vector3(-this.geometry.parameters.longLineSingle,0,0),new THREE.Vector3(-this.geometry.parameters.shortLine,this.geometry.parameters.sidelineSingle,0))},getAreaSingleFirstRightA:function(){return new THREE.Box3(new THREE.Vector3(-this.geometry.parameters.longLineSingle,
-this.geometry.parameters.sidelineSingle,0),new THREE.Vector3(-this.geometry.parameters.shortLine,0,0))},getAreaSingleB:function(){return new THREE.Box3(new THREE.Vector3(0,-this.geometry.parameters.sidelineSingle,0),new THREE.Vector3(this.geometry.parameters.longLineSingle,this.geometry.parameters.sidelineSingle,0))},getAreaSingleFirstB:function(){return new THREE.Box3(new THREE.Vector3(this.geometry.parameters.shortLine,-this.geometry.parameters.sidelineSingle,0),new THREE.Vector3(this.geometry.parameters.longLineSingle,
this.geometry.parameters.sidelineSingle,0))},getAreaSingleFirstLeftB:function(){return new THREE.Box3(new THREE.Vector3(this.geometry.parameters.shortLine,-this.geometry.parameters.sidelineSingle,0),new THREE.Vector3(this.geometry.parameters.longLineSingle,0,0))},getAreaSingleFirstRightB:function(){return new THREE.Box3(new THREE.Vector3(this.geometry.parameters.shortLine,0,0),new THREE.Vector3(this.geometry.parameters.longLineSingle,this.geometry.parameters.sidelineSingle,0))}});H.prototype=Object.assign(Object.create(THREE.Object3D.prototype),
{constructor:H,setText:function(a){this.text=a;this.textMesh&&(this.plane.remove(this.textMesh),this.textMesh=null);null!==a&&(a=new THREE.Mesh(new THREE.TextGeometry(a,{font:this.parameters.font,height:.1}),new THREE.MeshNormalMaterial),a.geometry.computeBoundingBox(),a.scale.set(.8*this.parameters.width/(a.geometry.boundingBox.max.x-a.geometry.boundingBox.min.x),.8*this.parameters.height/(a.geometry.boundingBox.max.y-a.geometry.boundingBox.min.y),1),a.position.x=-.45*this.parameters.width,a.position.y=
-.45*this.parameters.height,a.position.z=.1,this.plane.add(a),this.textMesh=a)}});M.prototype=Object.assign(Object.create(THREE.Object3D.prototype),{constructor:M,setCardAction:function(a,b,c){var d=this.frontCards[a],f=this.backCards[a],e=this.animateCards[a];"next"===c?(e.setText(b),e.rotation.x=f.rotation.x,e.visible=!0):(e.setText(d.text),e.rotation.x=d.rotation.x,e.visible=!0,d.setText(b));this.actions[a]={text:b,cardNo:a,direction:c,frontCard:d,backCard:f,animateCard:e}},update:function(a){for(var b=
0;b<this.actions.length;b++)null!==this.actions[b]&&this.updateCard(a,this.actions[b])},updateCard:function(a,b){var c="next"===b.direction?b.frontCard:b.backCard,d=c.rotation.x-b.animateCard.rotation.x,f=this.speed*a*(0>d?-1:1);b.animateCard.rotation.x+=Math.abs(d)<Math.abs(f)?d:f;b.animateCard.rotation.x===c.rotation.x&&("next"===b.direction&&b.frontCard.setText(b.text),b.animateCard.visible=!1,this.actions[b.cardNo]=null)}});N.prototype=Object.assign(Object.create(THREE.Object3D.prototype),{constructor:N,
update:function(a,b){this.lookAt(b.position.clone().setY(this.localToWorld(new THREE.Vector3(0,0,0)).y));0<this.arrowDir?(this.arrow.position.y+=this.arrowSpeed*a,this.arrow.position.y>this.arrowMaxY&&(this.arrow.position.y=this.arrowMaxY,this.arrowDir*=-1)):(this.arrow.position.y-=this.arrowSpeed*a,this.arrow.position.y<this.arrowMinY&&(this.arrow.position.y=this.arrowMinY,this.arrowDir*=-1))}});O.prototype={constructor:O,get lastWinnerScore(){return this["score"+this.lastWinner]},set lastWinnerScore(a){this["score"+
this.lastWinner]=a},nextScore:function(){this.nthScore++},update:function(a){if(this.nthScore!==this.score1+this.score2)if("hung"===this.shuttle.state)this.lastWinner=0===this.shuttle.impactCount%2?this.lastWinner:this.lastWinner%2+1,this.lastWinnerScore++,this.updateScoreboard(),this.onScoreChange();else if("toppled"===this.shuttle.state){a=1>=this.shuttle.impactCount?1===this.lastWinner?this.court.getArea("SingleFirst"+(0===this.score1%2?"Right":"Left")+"B"):this.court.getArea("SingleFirst"+(0===
this.score2%2?"Right":"Left")+"A"):1===this.lastWinner?1===this.shuttle.impactCount%2?this.court.getAreaSingleB():this.court.getAreaSingleA():1===this.shuttle.impactCount%2?this.court.getAreaSingleA():this.court.getAreaSingleB();this.court.localToTarget(a,this.shuttle.parent);var b=this.shuttle.localToTarget(new THREE.Vector3(0,0,0),this.court);this.lastWinner=b.x>=a.min.x&&b.x<=a.max.x&&b.z>=a.min.z&&b.z<=a.max.z?1===this.shuttle.impactCount%2?this.lastWinner:this.lastWinner%2+1:0===this.shuttle.impactCount%
2?this.lastWinner:this.lastWinner%2+1;this.lastWinnerScore++;this.updateScoreboard();this.onScoreChange()}},updateScoreboard:function(){this.scoreboard&&(1===this.lastWinner?this.scoreboard.setCardAction(0,this.score1.toString(),"next"):this.scoreboard.setCardAction(3,this.score2.toString(),"next"))},onScoreChange:function(){}};P.prototype={constructor:P,recordRobot:function(a){this.data.next.push(this.getRobotData(a))},resetCounter:function(){this.counter=0},init:function(a){this.data=a||{init:{score1:this.game.score1,
score2:this.game.score2,nthScore:this.game.nthScore,firstPlayer:this.game.lastWinner,shuttlecock:this.getShuttlecockData(this.shuttlecock),robot1:this.getRobotInitData(this.robot1),robot2:this.getRobotInitData(this.robot2)},next:[]}},play:function(){this.resetCounter();this.game.score1=this.data.init.score1;this.game.score2=this.data.init.score2;this.game.nthScore=this.data.init.nthScore;this.game.lastWinner=this.data.init.firstPlayer;this.scoreboard.frontCard1.setText(this.game.score1.toString());
this.scoreboard.frontCard2.setText(this.game.score2.toString());this.setRobotInit(this.robot1,this.data.init.robot1,this.targetPoint1);this.setRobotInit(this.robot2,this.data.init.robot2,this.targetPoint2);this.setShuttlecock(this.shuttlecock,this.data.init.shuttlecock);this.playRobot()},playRobot:function(){var a=this.data.next[this.counter];a&&this.setRobot(1===(0===this.counter%2?this.data.init.firstPlayer:this.data.init.firstPlayer%2+1)?this.robot1:this.robot2,a);this.playing=++this.counter<this.data.next.length},
getShuttlecockData:function(a){return{state:a.state,position:a.position.toArray(),rotation:a.rotation.toArray(),velocity:a.velocity.toArray(),impactCount:a.impactCount}},setShuttlecock:function(a,b){a.state=b.state;a.position.fromArray(b.position);a.rotation.fromArray(b.rotation);a.velocity.fromArray(b.velocity);a.impactCount=b.impactCount},getRobotInitData:function(a){return{responsibleArea:a.responsibleArea.toArray(),impactCount:a.impactCount,healthPercent:a.healthPercent,bodyAngle:a.body.rotation.y,
position:a.position.toArray(),rotation:a.rotation.toArray()}},setRobotInit:function(a,b){a.responsibleArea.fromArray(b.responsibleArea);a.impactCount=b.impactCount;a.healthPercent=b.healthPercent;a.body.rotation.y=b.bodyAngle;a.position.fromArray(b.position);a.rotation.fromArray(b.rotation)},getRobotData:function(a){return{impactType:a.impactType,targetPosition:a.targetPosition.toArray()}},setRobot:function(a,b){a.impactType=b.impactType;a.targetPosition.fromArray(b.targetPosition);var c=a===this.robot1?
this.targetPoint1:this.targetPoint2;c&&c.position.fromArray(b.targetPosition)}};m.ShuttlecockGeometry=u;m.HyperbolaGeometry=y;m.NetGeometry=D;m.CourtGeometry=E;m.RacketGeometry=F;m.PixelMaterial=G;m.Shuttlecock=J;m.Robot=K;m.Court=L;m.Scoreboard=M;m.ScoreboardCard=H;m.TargetPoint=N;m.Game=O;m.Record=P;Object.defineProperty(m,"__esModule",{value:!0})});
